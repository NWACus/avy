name: preview
on:
  pull_request:
    branches:
      - develop2
    paths-ignore:
      - 'docs/**'
      - '**/*.md'
      - '.github/ISSUE_TEMPLATE/*'

defaults:
  run:
    shell: bash

jobs:
  ci:
    uses: ./.github/workflows/ci.yaml # use the callable ci job to run CI checks

  publish_expo_update:
    needs: [ci]
    runs-on: ubuntu-latest
    steps:
      - name: üèó Setup repo
        uses: actions/checkout@v2

      - name: Publish EAS update
        uses: ./.github/actions/expo/update
        with:
          pull_request: ${{ github.event.number }}
          channel: 'yulia-pr-${{ github.event.number }}'
          message: '${{ github.event.pull_request.title }}'
          expo_token: ${{ secrets.EXPO_TOKEN }}
